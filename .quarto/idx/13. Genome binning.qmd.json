{"title":"13. Genome binning","markdown":{"headingText":"13. Genome binning","containsRefs":false,"markdown":"\nGenome binning is a common step in metagenomic analysis and can be thought of an extension of genome assembly. In this process, we group assembled contigs into individual genome bins, in order to reconstruct metagenome-assembled genomes (MAGs). Genome binning tools use a variety of different approaches to group these contigs including: sequence composition-based binning, sequencing depth and coverage based binning, machine learning based methods, and hybrid methods that combine multiple informaton sources. Each of these methods have their own pros and cons, and the choice of which to use is often sample and experiment dependent. A detailed review on these binning approaches can be found [here](https://pubmed.ncbi.nlm.nih.gov/34900140/).\n\n## Binning with MetaBat2\n\nIn this course we will be using MetaBat2 as our genome binning tool of choice. This tool is available through conda, but it is not recommended or supported by the developers of MetaBat. However, details on how to install the tool are quite clear on the tools [bitbucket](https://bitbucket.org/berkeleylab/metabat/src/master/) (Follow the non-Docker installation unless you are already familiar with Docker or want to experiment).\n\nMetaBat2 requires two input files: the assembled contigs we generated with MEGAHIT and a sorted BAM file containing the read coverage data for each contig. This can be generated by mapping the reads that we used to assemble the contigs to the assembled contigs, with a mapping tool such as [BWA](https://github.com/lh3/bwa). Install BWA via conda and run:\n\n```bash\nbwa mem final.contigs.fa sample1_R1.fq sample1_R2.fq > sample1_aln.sam\n```\n\nThis generates a SAM file, but MetaBat2 requires a sorted BAM file. A SAM is a human-readable alignment format and a BAM file is the binary version of that. We can convert a SAM file to a sorted BAM file with SAMtools, which can be installed via conda.\n\n```bash\nsamtools sort sample1_aln.sam -o sample1_aln_sorted.bam\n```\n\nNow that we have both our assembled contigs and a sorted bam file we can run MetaBat2 to get our MAGs. Look at the MetaBat2 bitbucket page and try and run MetaBat2 using our two input files and an output directory named *sample1_metabat2_out*, whilst keeping other options as default. MetaBat2 will then generate FASTA files for all the binned and unbinned contigs.\n\n### Evaluating Quality of Metagenomic Bins with CheckM\nCheckM is a powerful tool designed to assess the quality of MAGs. It provides estimates of genome completeness and contamination by utilising lineage-specific marker genes that are ubiquitous and single-copy within a phylogenetic lineage. CheckM can be easily installed via conda. Reference data is required for CheckM to function and details on how to download and prepare the data can be found on CheckM's [wiki](https://github.com/Ecogenomics/CheckM/wiki/Installation#how-to-install-checkm). The standard workflow for CheckM is the lineage_wf which can be run with:\n\n```bash\ncheckm lineage_wf <bin folder> <output folder>\n```\n\nCheckM provides several important functionalities for assessing genome quality including:\n* Estimation of Genome Completeness\n* Estimation of Genome Contamination\n* Identification of Potential Misassemblies\n\nYou should read the extensive CheckM wiki for details on how these metrics are calculated and what they mean. However, there are a few particular things to look out for in the CheckM output:\n\n* Low Completeness Scores: Bins with completeness scores below 70% may indicate that significant portions of the genome are missing.\n* High Contamination Scores: Contamination scores above 5% are concerning, as they suggest that the bin may contain DNA from multiple organisms, complicating downstream analyses.\n* Presence of Duplicate Marker Genes: If marker genes that are expected to be single-copy appear as duplicates, it may indicate contamination or misassemblies.\n* Inconsistent Lineage Assignments: If a genome bin is classified with a broad marker set (e.g., domain-level) rather than a specific lineage, it may indicate uncertainty in the classification and quality of the genome.\n\nDecisions on what to do with bins are left up to the researcher but in my own pipelines I typically remove bins with less than 50% completeness and over 10% contamination. This ensures that the average quality of my bins are high, without discarding the majority of the bins.\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"13. Genome binning.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.361","theme":{"light":"cosmo"},"code-copy":true,"code-block-border-left":true,"code-block-bg":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}