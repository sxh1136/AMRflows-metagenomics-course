{"title":"9.5. Processing Paired-End Data with for Loops","markdown":{"headingText":"9.5. Processing Paired-End Data with for Loops","containsRefs":false,"markdown":"\nIn metagenomics, you often work with paired-end sequencing data, where each sample consists of two separate FASTQ filesâ€”one for forward reads and one for reverse reads. Fortunately, fastp can handle paired-end data efficiently when used in combination with for loops. Let's dive into how you can set up and execute for loops for paired-end data, making use of variable string substitution.\n\n### Preparing Paired-End Data\n\nBefore we start, ensure that your paired-end FASTQ files are organized correctly. You should have a directory containing pairs of files, with one file for forward reads and another for reverse reads for each sample. The filenames should ideally follow a pattern to simplify automation. For example a set of pair reads would be named:\n\n* amrfA1_R1.fastq\n* amrfA1_R2.fastq\n\n### Using for Loops for Paired-End Data\n\nTo process paired-end data with fastp using for loops, you'll need to set up a loop that iterates over both the forward and reverse reads simultaneously. Here's an example of how to do it:\n\n```bash\nfor r in *_R1.fastq; do fastp -i ${r} -I ${r/R1/R2} -o ${r/R1.fastq/processed_R1.fastq} -O ${r/R1.fastq/processed_R2.fastq} -h ${r/R1.fastq/fastp.html};done\n```\n\nNote that we use variable/parameter substitution here to change our variable `r` which contains the name of the forward read into the name of the reverse read. This works as follows:\n\n`${parameter/pattern/replacement}`\n\nSo if the parameter `r` represented amrfA1_R1.fastq the substitution `${r/R1/R2}` would replace the pattern `R1` with `R2`, resulting in amrfA1_R2.fastq.\n\nLet's break down what each part of the loop does:\n\n`for r in *_R1.fastq`: This line iterates through all files in the current directory that end with \"_R1.fastq,\" representing the forward reads.\n`do fastp`: This starts the for loop for fastp.\n`-i ${r}`: This inputs the files that end in \"_R1.fastq\" into fastp.\n`-I ${r/R1/R2}`: This line constructs the filename for the reverse reads by substituting \"R1\" with \"R2\" in the forward read variable.\n`-o ${r/R1.fastq/processed_R1.fastq}`: This line names the processed output forward reads by replacing the \"R1.fastq\" string from the forward read filename with \"procressed_R1.fastq\"\n`-O ${r/R1.fastq/processed_R2.fastq}`: This line names the processed output reverse reads by replacing the \"R1.fastq\" string from the forward read filename with \"processed_R2.fastq\"\n`-h ${r/R1.fastq/fastp.html}`: This line names the output html file by replacing the \"R1.fastq\" string from the forward read filename with \"fastp.html\"\n`done`: Ends the for loop.\n\nWhen you run this loop, it will automatically process each pair of forward and reverse reads in a single command. If we echo the above command, assuming `amrfA1_R1.fastq` and `amrfA1_R2.fastq` are the only files in our current directory, the output would be:\n\n```bash\nfastp -i amrfA1_R1.fastq -I amrfA1_R2.fastq -o amrfA1_processed_R1.fastq -O amrfA1_processed_R2.fastq -h amrfA1_fastp.html\n```\n\nOf course, just running the command above would get us the same result, but imagine doing this for hundreds of paired reads. For loops allow us to do this all in one command, instead of writing code for every set of paired reads. \n\n### Recap and Practice\n\nIn this section, you've learned how to use for loops with fastp to efficiently process paired-end sequencing data. Variable string substitution allows you to create dynamic filenames and automate the handling of both forward and reverse reads.\n\nExercise: Process Paired-End Data\n\n* Activate your Conda environment.\n* Navigate to the directory containing your paired-end sequencing data files.\n* Write a for loop like those provided above into your command line.\n* Run the loop to process both forward and reverse reads.\n* Examine the processed files, ensuring that the quality control and preprocessing were successful.\n\n<details>\n<summary>Example code for exercise</summary>\n\n```bash\nconda activate fastp_env\ncd sequencing_data\nfor r in *_R1.fastq; do fastp -i ${r} -I ${r/R1/R2} -o ${r/R1.fastq/processed_R1.fastq} -O ${r/R1.fastq/processed_R2.fastq} -h ${r/R1.fastq/fastp.html};done\n```\n</details>\n\nBy mastering the use of for loops and variable string substitution, you're equipped to tackle paired-end data efficiently in your metagenomic analyses. There are other ways to manipulate variable strings in Bash, but substitution is by far the most used. If you want to read about other types of variable manipulation/expansion this wiki has a great table of various tricks:\n\nhttps://mywiki.wooledge.org/BashGuide/Parameters#Parameter_Expansion","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"9.5. Paired-End-Data.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.361","theme":{"light":"cosmo"},"code-copy":true,"code-block-border-left":true,"code-block-bg":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}