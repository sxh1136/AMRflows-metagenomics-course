{"title":"8. Running Your First Bioinformatics Tool - fastp","markdown":{"headingText":"8. Running Your First Bioinformatics Tool - fastp","containsRefs":false,"markdown":"In this section we will use our first bioinformatics tool, `fastp`. Before we start I want to repeat that the number one skill that you need to learn as a bioinformatian is to be able to read and understand software manuals. Manuals are available on the software's website or on their GitHub page. Step one of running a new tool is to always read the *entire* manual. Not reading the full manual leads to a lot of mistakes that waste computational time. If you run into any issues, the first time to do is to read the manual again. Programs often include a help section that is accessible on the command line. For the vast majority of the tools, you just type the name of the program followed by the flag `-h`, `--help`, or `-help`. This is very useful for refreshing our memory on what different flags are and what they do in that particular program.\n\n### Introducing fastp - Read Quality Control and Preprocessing \n\nThe tool fastp combines quality assessment and read processing, streamlining your analysis pipeline. There are also tools such as fastqc, prinseq, trimmomatic etc., but I have a preference for fastp because:\n\n* All-in-One: fastp performs both quality control and preprocessing tasks, reducing the need for multiple tools.\n\n* Speed: As the name suggests, fastp is designed for speed, making it efficient for processing large datasets.\n\n* Adapter Trimming: fastp also performs automatic adapter trimming and removes unwanted sequences from your reads.\n\n### Installing fastp\n\nBefore we start we need to ensure that fastp is installed in your Conda environment. If not already done, activate the desired environment and install fastp using this command:\n\n```bash\nconda install -c bioconda fastp\n```\n\nYou can also create a conda environment specifically for fastp to ensure there are no dependency clashes.\n\n```bash\nconda create --name fastp_env -c bioconda fastp\nconda activate fastp_env\n```\n\nWith fastp installed, you're ready to assess the quality of your sequencing data.\n\n### Using fastp for Quality Control and Preprocessing\n\nStep 1: Prepare Your Data\n* Open a command line or terminal window.\n* Gather your raw sequencing data files and place them in a directory.\n\nStep 2: Run fastp\n* Run fastp with the following command (replace input.fastq and output.fastq with your filenames):\n\n```bash\nfastp -i input.fastq -o output.fastq -h output.html\n```\n\nfastp will analyze the data, generate a quality report in html format, and preprocess the reads into output.fastq.\n\n* Note: We'll go through how to run fastp on multiple files and on paired-end reads in later sections. \n\n### Exploring fastp's Quality Control Reports\nAs part of its functionality, fastp produces quality control reports that provide insight into the state of your data. The reports are generated in HTML format and can be viewed in a web browser.\n\n\nOpen the HTML report in a web browser to explore key metrics:\n\n* Adapter content\n* Duplication rate\n* Total reads/bases before and after filtering\n* Read quality (Q20 and Q30) before and aftering filtering\n* GC ratio\n* Mean length\n  \nBy default, fastp removes reads with over 40% of bases below a phred quality of 15. The phred quality threshold can be adjusted with the `-q` flag. It also automatically trims adaptor sequences by overlap analysis. If you know the adaptor sequence for your reads you can specify them after the `a` flag. fastp also has other features, such as global trimming, read deduplication, overrepresented sequence analysis, and read merging. Details of all of fastp's features and how to use the additonal modes can be found at: https://github.com/OpenGene/fastp\n\nFor the majority of Illumina metagenomic reads, running through fastp's default settings will be sufficient for producing clean input data for downstream analysis. However, it is important to manually inspect the html output from fastp in order to spot any potential issues. \n\n### Recap\n\nIn this section, you've explored read quality control and preprocessing using the fastp tool. You've gained insights into installing fastp, running quality control and preprocessing, and interpreting quality reports. Now, it's time to apply this knowledge to your own metagenomic data.\n\n### Exercise\n\n* Activate your Conda environment.\n\n* Navigate to the directory containing your raw sequencing data files.\n\n* Run fastp on one fastq file.\n\n* Open and examine the generated fastp quality control report in a web browser.\n\n<details>\n<summary>Example code for exercise</summary>\n\n```bash\nconda activate fastp_env\ncd sequencing_data\nfastp -i input.fastq -o output.fastq -h output.html\n```\n</details>\n\nBy incorporating fastp into your workflow, you've taken a important step towards ensuring accurate and reliable metagenomic analyses. In the next sections, we'll explore how to run fastp on multiple fastq files, as well as on paired-end data.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"8. Read Quality Control.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.361","theme":{"light":"cosmo"},"code-copy":true,"code-block-border-left":true,"code-block-bg":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}